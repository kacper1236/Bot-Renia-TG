# Twój własny obraz bazowy
FROM python:3.14-slim

# Instalacja wszystkich zależności systemowych, które zawsze są potrzebne
RUN apt-get update && \
    apt-get upgrade -y && \
    apt-get install -y --no-install-recommends \
        postgresql-client \
        libpq-dev \
        gcc \
        python3-dev && \
    apt-get clean && rm -rf /var/lib/apt/lists/*

# Możesz też od razu zainstalować pip dependencies, jeśli są wspólne
# RUN pip install --upgrade pip setuptools


#następnie build
docker build -f Dockerfile.base -t my-python-base:3.14 .


#potem
# Bazowanie na własnym obrazie
FROM my-python-base:3.14

WORKDIR /app

COPY requirements.txt /app/requirements.txt
RUN pip install --upgrade -r requirements.txt --use-pep517 --use-feature=fast-deps

COPY . /app

EXPOSE 5001
ENTRYPOINT ["./start_server.sh"]

